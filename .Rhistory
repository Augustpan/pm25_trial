xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
qplot(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)) +
geom_smooth(method="lm", se=F) +
geom_text(x=1.2, y=60, label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
qplot(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)) +
geom_smooth(method="lm", se=F) +
geom_text(label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(method="lm", se=F) +
geom_text(label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(x=0.6, y=5, label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=5), label="FUNK") +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=5, label="FUNK")) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=5, label="FUNK")) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
sb = summary(fit_B)
library(tidyverse)
# 标准管浓度
c_std = c(800, 400, 200, 100, 50)
# 标准管吸光度
abs_std_group_B = c(1.787,1.1154,0.6308,0.2728,0.1478)
abs_std_group_AC = c(1.589, 1.1978, 0.8116, 0.4093, 0.2267)
# 空白管吸光度
abs_blank_group_B = 0.0527
abs_blank_group_AC = 0.4673
# 拟合标准曲线
fit_B = lm(abs_std_group_B - abs_blank_group_B ~ log(c_std))
fit_AC = lm(abs_std_group_AC - abs_blank_group_AC ~ log(c_std))
sb = summary(fit_B)
sb
sb$r.squared
library(tidyverse)
# 标准管浓度
c_std = c(800, 400, 200, 100, 50)
# 标准管吸光度
abs_std_group_B = c(1.787,1.1154,0.6308,0.2728,0.1478)
abs_std_group_AC = c(1.589, 1.1978, 0.8116, 0.4093, 0.2267)
# 空白管吸光度
abs_blank_group_B = 0.0527
abs_blank_group_AC = 0.4673
# 拟合标准曲线
fit_B = lm(abs_std_group_B - abs_blank_group_B ~ log(c_std)) %>% summary()
fit_AC = lm(abs_std_group_AC - abs_blank_group_AC ~ log(c_std)) %>% summary()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=5, label=paste0("R2=", fit_B$r.squared))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4, label=paste0("R2=", fit_B$r.squared))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4, label=paste0("R2=", round(fit_B$r.squared*100)/100))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4, label=paste0("R-square=", round(fit_B$r.squared*100)/100, ))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
fit_AC
fit_AC$coefficients[1]
fit_AC$coefficients[2]
fit_AC$coefficients
summ_AC = paste0(
"R-square=",
round(fit_AC$r.squared*100)/100,
"\ry = ",
round(fit_AC$coefficients[1]*10000)/10000,
" + ",
round(fit_AC$coefficients[2]*10000)/10000,
" x",
)
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4, label=summ_AC)) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
summ_AC = paste0(
"R-square=",
round(fit_AC$r.squared*100)/100,
"\\ry = ",
round(fit_AC$coefficients[1]*10000)/10000,
" + ",
round(fit_AC$coefficients[2]*10000)/10000,
" x",
)
summ_AC = paste0(
"R-square=",
round(fit_AC$r.squared*100)/100,
"y = ",
round(fit_AC$coefficients[1]*10000)/10000,
" + ",
round(fit_AC$coefficients[2]*10000)/10000,
" x",
)
summ_AC = paste0(
"R-square=",
round(fit_AC$r.squared*100)/100,
"\ry = ",
round(fit_AC$coefficients[1]*10000)/10000,
" + ",
round(fit_AC$coefficients[2]*10000)/10000,
" x"
)
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4, label=summ_AC)) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(x=0.6, y=4.7, label=paste0("R-square=", round(fit_AC$r.squared*100)/100))) +
geom_text(aes(x=0.6, y=4.4, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("R-square=", round(fit_AC$r.squared*100)/100))) +
geom_text(aes(hjust=0, x=0.6, y=4.4, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("R-square=", round(fit_AC$r.squared*100)/100))) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*100)/100))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*100)/100))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("y = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * ln(x)"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std))) +
geom_smooth(aes(x=abs_std_group_AC-abs_blank_group_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()x_B = abs_std_group_B - abs_blank_group_B
x_AC = abs_std_group_AC - abs_blank_group_AC
fit_B = lm(log(c_std)~x_B) %>% summary()
fit_AC = lm(log(c_std)~x_AC) %>% summary()
ggplot() +
geom_point(aes(x=x_AC, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
source('~/Desktop/workspace/raw.R')
ggplot() +
geom_point(aes(x=x_AC, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_AC, y=log(c_std))) +
geom_smooth(aes(x=x_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_B, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_B$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_B, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=1.2, y=4.5, label=paste0("R-square=", round(fit_B$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=1.2, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_B, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=1, y=4.5, label=paste0("R-square=", round(fit_B$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=1, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_AC, y=log(c_std))) +
geom_smooth(aes(x=x_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
raw_AC = read_csv("data/raw_8isoPGF_group_AC.csv")
fit_AC$coefficients
fit_AC$coefficients[1]
fit_AC$coefficients[2]
raw_AC$PGF = exp(raw_AC$OD * fit_AC$coefficients[2] + fit_AC$coefficients[1])
raw_AC
source('~/Desktop/workspace/raw.R')
raw_AC
source('~/Desktop/workspace/raw.R')
df
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/std_curve.R')
View(df)
library(tidyverse)
# PART1 读取全部pm2.5个体暴露数据
## 这些数据储存在data/PM2.5文件夹下，文件名必须是实验对象的编号如A1.txt等
## 扫描data/PM2.5文件
flist = list.files("./pm25")
sp = strsplit(flist, "\\.")
## 重新定义英文列名
cname = c("index", "date", "time", "pm1_std", "pm25_std", "pm10_std", "pm1_gas", "pm25_gas", "pm10_gas", "voltage", "empty")
## 定义变量类型
ctype = cols(
index = col_double(),
date = col_character(),
time = col_character(),
pm1_std = col_double(),
pm25_std = col_double(),
pm10_std = col_double(),
pm1_gas = col_double(),
pm25_gas = col_double(),
pm10_gas = col_double(),
voltage = col_double(),
empty = col_skip()
)
## 循环读入所有人的暴露数据，读入的数据存储在变量df里
df = tibble()
for (i in 1:length(sp)) {
if (sp[[i]][2] == "txt") {
tdf = read_tsv(paste0("./pm25/", sp[[i]][1], ".txt"), col_names = cname, col_types = ctype, skip=1)
tdf$object = sp[[i]][1]
date_temp = as.Date(tdf$date, "%y-%m-%d")
date_alter = as.Date(tdf$date, "%Y/%m/%d")
mask = is.na(date_temp)
date_temp[mask] = date_alter[mask]
tdf$datetime = paste(date_temp, tdf$time) %>% strptime("%Y-%m-%d %H-%M") %>% as.POSIXct()
df = bind_rows(df, tdf)
}
}
source('~/Desktop/pm25_trial/pm25.R')
sp
flist = list.files("./pm25")
sp = strsplit(flist, "\\.")
sp
source('~/Desktop/pm25_trial/pm25.R')
sp
list.files("./data/pm25")
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
df
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B1.TXT")
ctype = cols(
index = col_double(),
date = col_character(),
time = col_character(),
pm1_std = col_double(),
pm25_std = col_double(),
pm10_std = col_double(),
pm1_gas = col_double(),
pm25_gas = col_double(),
pm10_gas = col_double(),
voltage = col_double()
)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", skip=1)
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.txt", col_names = cname,skip=1)
read.delim("data/PM2.5/B1.txt")
read.delim("data/PM2.5/B1.txt")
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B2.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B3.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B4.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B6.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B7.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B8.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B9.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
df %>% filter(object = "B10")
df %>% filter(object == "B10")
df %>%
mutate(time_diff=df$datetime-doi) %>%
filter(time_diff >= -lag*60 & time_diff <= 0) %>%
group_by(object) %>%
summarise(pm1_std = mean(pm1_std))
mutate(time_diff=df$datetime-doi)
mutate(df,time_diff=df$datetime-doi)
mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")
mutate(df,time_diff=df$datetime-doi) %>% select(time_diff)%>% filter(object=="B10")
mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")%>% select(time_diff)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")%>% select(time_diff)
x$time_diff
plot(z)
plot(x)
x$time_diff
x
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B9")%>% select(time_diff)
x$time_diff
x
x %>% filter(abs(time_diff) < 10)
x %>% filter(abs(time_diff) < 100)
x %>% filter(abs(time_diff) < 200)
x %>% filter(abs(time_diff) < 300)
x %>% filter(abs(time_diff) < 10000)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C9")%>% select(time_diff)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C1")%>% select(time_diff)
doi1 - doi2
doi1 doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")- doi2
doi1 - doi2
doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2
doi1 - doi2doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2
abs(doi1 - doi2)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C9")%>% select(time_diff)
z
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="C9")%>% select(time_diff)
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="C9") %>% select(time_diff)
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="B10") %>% select(time_diff)
x
x$time_diff < 8 * 60
calc_average(df, doi, lag)
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins"))
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(object=="B10") %>%
select(time_diff)
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(time_diff >= -lag*60 & time_diff <= 0 & object=="B10")
LAG
lag
lag*60
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(time_diff >= -lag*60 & time_diff <= 0) %>%
group_by(object) %>%
summarise(pm1_std = mean(pm1_std), nn = n())
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B10"))
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B9"))
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B8"))
summary(df$pm25_std)
qplot(x=datetime,y=pm1_std,data=df)
qplot(x=datetime,y=pm25_std,data=df%>%filter(pm25_std > 1000))
qplot(x=datetime,y=pm25_std,data=df%>%filter(pm25_std < 1000))
qplot(x=datetime,y=pm25_std,data=df)
df
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
calc_average(df, doi, lag)
calc_average(df, doi1, lag)
calc_average(df, doi2, lag)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi2, lag)
calc_average(df, doi2, 24)
calc_average(df, doi2, 12)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi2, 12)
calc_average(df, doi2, 12)
calc_average(df, doi2, 24)
calc_average(df, doi1, 24)
calc_average(df, doi2, 24)
calc_average(df, doi2, 48)
