geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_B, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=1.2, y=4.5, label=paste0("R-square=", round(fit_B$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=1.2, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_B, y=log(c_std))) +
geom_smooth(aes(x=x_B, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=1, y=4.5, label=paste0("R-square=", round(fit_B$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=1, y=4.7, label=paste0("ln(y) = ", round(fit_B$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
ggplot() +
geom_point(aes(x=x_AC, y=log(c_std))) +
geom_smooth(aes(x=x_AC, y=log(c_std)), method="lm", se=F) +
geom_text(aes(hjust=0, x=0.6, y=4.5, label=paste0("R-square=", round(fit_AC$r.squared*10000)/10000))) +
geom_text(aes(hjust=0, x=0.6, y=4.7, label=paste0("ln(y) = ", round(fit_AC$coefficients[1]*10000)/10000, " + ", round(fit_AC$coefficients[2]*10000)/10000, " * x"
))) +
xlab("O.D.") +
ylab("log(8-iso)") +
theme_classic()
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
raw_AC = read_csv("data/raw_8isoPGF_group_AC.csv")
fit_AC$coefficients
fit_AC$coefficients[1]
fit_AC$coefficients[2]
raw_AC$PGF = exp(raw_AC$OD * fit_AC$coefficients[2] + fit_AC$coefficients[1])
raw_AC
source('~/Desktop/workspace/raw.R')
raw_AC
source('~/Desktop/workspace/raw.R')
df
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/raw.R')
source('~/Desktop/workspace/std_curve.R')
View(df)
library(tidyverse)
# PART1 读取全部pm2.5个体暴露数据
## 这些数据储存在data/PM2.5文件夹下，文件名必须是实验对象的编号如A1.txt等
## 扫描data/PM2.5文件
flist = list.files("./pm25")
sp = strsplit(flist, "\\.")
## 重新定义英文列名
cname = c("index", "date", "time", "pm1_std", "pm25_std", "pm10_std", "pm1_gas", "pm25_gas", "pm10_gas", "voltage", "empty")
## 定义变量类型
ctype = cols(
index = col_double(),
date = col_character(),
time = col_character(),
pm1_std = col_double(),
pm25_std = col_double(),
pm10_std = col_double(),
pm1_gas = col_double(),
pm25_gas = col_double(),
pm10_gas = col_double(),
voltage = col_double(),
empty = col_skip()
)
## 循环读入所有人的暴露数据，读入的数据存储在变量df里
df = tibble()
for (i in 1:length(sp)) {
if (sp[[i]][2] == "txt") {
tdf = read_tsv(paste0("./pm25/", sp[[i]][1], ".txt"), col_names = cname, col_types = ctype, skip=1)
tdf$object = sp[[i]][1]
date_temp = as.Date(tdf$date, "%y-%m-%d")
date_alter = as.Date(tdf$date, "%Y/%m/%d")
mask = is.na(date_temp)
date_temp[mask] = date_alter[mask]
tdf$datetime = paste(date_temp, tdf$time) %>% strptime("%Y-%m-%d %H-%M") %>% as.POSIXct()
df = bind_rows(df, tdf)
}
}
source('~/Desktop/pm25_trial/pm25.R')
sp
flist = list.files("./pm25")
sp = strsplit(flist, "\\.")
sp
source('~/Desktop/pm25_trial/pm25.R')
sp
list.files("./data/pm25")
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
df
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B1.TXT")
ctype = cols(
index = col_double(),
date = col_character(),
time = col_character(),
pm1_std = col_double(),
pm25_std = col_double(),
pm10_std = col_double(),
pm1_gas = col_double(),
pm25_gas = col_double(),
pm10_gas = col_double(),
voltage = col_double()
)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", skip=1)
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT")
read_tsv("data/PM2.5/B1.TXT", col_names = cname,skip=1)
read_tsv("data/PM2.5/B1.txt", col_names = cname,skip=1)
read.delim("data/PM2.5/B1.txt")
read.delim("data/PM2.5/B1.txt")
read_tsv("data/PM2.5/B1.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B2.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B3.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B4.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B5.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B6.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B7.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B8.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B9.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
read_tsv("data/PM2.5/B10.TXT", col_names = cname, col_types = ctype, skip=1)
df %>% filter(object = "B10")
df %>% filter(object == "B10")
df %>%
mutate(time_diff=df$datetime-doi) %>%
filter(time_diff >= -lag*60 & time_diff <= 0) %>%
group_by(object) %>%
summarise(pm1_std = mean(pm1_std))
mutate(time_diff=df$datetime-doi)
mutate(df,time_diff=df$datetime-doi)
mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")
mutate(df,time_diff=df$datetime-doi) %>% select(time_diff)%>% filter(object=="B10")
mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")%>% select(time_diff)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B10")%>% select(time_diff)
x$time_diff
plot(z)
plot(x)
x$time_diff
x
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="B9")%>% select(time_diff)
x$time_diff
x
x %>% filter(abs(time_diff) < 10)
x %>% filter(abs(time_diff) < 100)
x %>% filter(abs(time_diff) < 200)
x %>% filter(abs(time_diff) < 300)
x %>% filter(abs(time_diff) < 10000)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C9")%>% select(time_diff)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C1")%>% select(time_diff)
doi1 - doi2
doi1 doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")- doi2
doi1 - doi2
doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2
doi1 - doi2doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 = strptime("20-11-8 08-00", "%y-%m-%d %H-%M")
doi2 = strptime("20-11-16 08-00", "%y-%m-%d %H-%M")
doi1 - doi2
abs(doi1 - doi2)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
x = mutate(df,time_diff=df$datetime-doi) %>% filter(object=="C9")%>% select(time_diff)
z
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="C9")%>% select(time_diff)
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="C9") %>% select(time_diff)
x
x = mutate(df,time_diff=difftime(df$datetime, doi, units="mins")) %>% filter(object=="B10") %>% select(time_diff)
x
x$time_diff < 8 * 60
calc_average(df, doi, lag)
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins"))
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(object=="B10") %>%
select(time_diff)
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(time_diff >= -lag*60 & time_diff <= 0 & object=="B10")
LAG
lag
lag*60
df %>%
mutate(time_diff=difftime(df$datetime, doi, units="mins")) %>%
filter(time_diff >= -lag*60 & time_diff <= 0) %>%
group_by(object) %>%
summarise(pm1_std = mean(pm1_std), nn = n())
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B10"))
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B9"))
qplot(x=datetime,y=pm1_std,data=df%>%filter(object=="B8"))
summary(df$pm25_std)
qplot(x=datetime,y=pm1_std,data=df)
qplot(x=datetime,y=pm25_std,data=df%>%filter(pm25_std > 1000))
qplot(x=datetime,y=pm25_std,data=df%>%filter(pm25_std < 1000))
qplot(x=datetime,y=pm25_std,data=df)
df
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi, lag)
calc_average(df, doi, lag)
calc_average(df, doi1, lag)
calc_average(df, doi2, lag)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi2, lag)
calc_average(df, doi2, 24)
calc_average(df, doi2, 12)
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi2, 12)
calc_average(df, doi2, 12)
calc_average(df, doi2, 24)
calc_average(df, doi1, 24)
calc_average(df, doi2, 24)
calc_average(df, doi2, 48)
library(tidyverse)
library(tidyverse)
# PART1 读取全部pm2.5个体暴露数据
## 这些数据储存在data/PM2.5文件夹下，文件名必须是实验对象的编号如A1.txt等
## 扫描data/PM2.5文件
flist = list.files("data/PM2.5")
sp = strsplit(flist, "\\.")
## 重新定义英文列名
cname = c("index", "date", "time", "pm1", "pm25", "pm10", "pm1_skip", "pm25_skip", "pm10_skip", "voltage", "empty")
## 定义变量类型
ctype = cols(
index = col_double(),
date = col_character(),
time = col_character(),
pm1 = col_double(),
pm25 = col_double(),
pm10 = col_double(),
pm1_skip = col_skip(),
pm25_skip = col_skip(),
pm10_skip = col_skip(),
voltage = col_skip(),
empty = col_skip()
)
## 循环读入所有人的暴露数据，读入的数据存储在变量df里
df = tibble()
for (i in 1:length(sp)) {
if (sp[[i]][2] == "txt") {
tdf = read_tsv(paste0("data/PM2.5/", sp[[i]][1], ".txt"), col_names = cname, col_types = ctype, skip=1)
tdf$object = sp[[i]][1]
date_temp = as.Date(tdf$date, "%y-%m-%d")
date_alter = as.Date(tdf$date, "%Y/%m/%d")
mask = is.na(date_temp)
date_temp[mask] = date_alter[mask]
tdf$datetime = paste(date_temp, tdf$time) %>% strptime("%Y-%m-%d %H-%M") %>% as.POSIXct()
df = bind_rows(df, tdf)
}
}
read_tsv(paste0("data/PM2.5/", "A1", ".txt"), col_names = cname, col_types = ctype, skip=1)
source('~/Desktop/pm25_trial/pm25.R')
read_tsv(paste0("data/PM2.5/", "A1", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A2", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A3", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A4", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A5", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A6", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A7", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A8", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A9", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A9", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A3", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A2", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A4", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A5", ".txt"), col_names = cname, col_types = ctype, skip=1)
read_tsv(paste0("data/PM2.5/", "A6", ".txt"), col_names = cname, col_types = ctype, skip=1)
df
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
calc_average(df, doi1, lag)
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/std_curve.R')
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
df
source('~/Desktop/pm25_trial/pm25.R')
pm_data
source('~/Desktop/pm25_trial/pm25.R')
pm_data
library(tidyverse)
load("data/pm_data.RData")
biomarker_data = read_csv("data/biomaker.csv")
treatment_data = read_csv("data/treatment.csv")
source('~/Desktop/pm25_trial/pm25.R')
source('~/Desktop/pm25_trial/pm25.R')
library(tidyverse)
load("data/pm_data.RData")
biomarker_data = read_csv("data/biomaker.csv")
treatment_data = read_csv("data/treatment.csv")
library(tidyverse)
load("data/pm_data.RData")
biomarker_data = read_csv("data/biomaker.csv")
treatment_data = read_csv("data/treatment.csv")
pm_dat
pm_data
View(treatment_data)
biomarker_data
treatment_data
pm_data
biomarker_data
source('~/Desktop/pm25_trial/analysis.R')
source('~/Desktop/pm25_trial/analysis.R')
treatment_data
View(biomarker_data)
spread(biomarker_data, date, PGF)
spread(biomarker_data, date,sample, PGF)
spread(biomarker_data, date, PGF)
View(doi2)
source('~/Desktop/pm25_trial/std_curve.R')
source('~/Desktop/pm25_trial/analysis.R')
biomarker
biomarker_data
spread(biomarker_data, date, PGF)
spread(biomarker_data, date, PGF) %>%
tibble(stage1_effect = .$`2020/11/8` - .$`2020/11/4`,
stage2_effect = .$`2020/11/16` - .$`2020/11/13`)
spread(biomarker_data, date, PGF) %>%
mutate(stage1_change = .$`2020/11/8` - .$`2020/11/4`,
stage2_change = .$`2020/11/16` - .$`2020/11/13`)
spread(biomarker_data, date, PGF) %>%
mutate(stage1_change = .$`2020/11/8` - .$`2020/11/4`,
stage2_change = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1_change, stage2_change)
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1_change = .$`2020/11/8` - .$`2020/11/4`,
stage2_change = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1_change, stage2_change) %>%
inner_join(treatment_data, by="subject")
treatment_data
source('~/Desktop/pm25_trial/analysis.R')
effect
effect %>% gather("stage", "change", effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject"))
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject")
effect %>% gather("stage", "effect", 2:3)
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject") %>%
gather("stage", "effect", 2:3)
effect
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2)
effect
source('~/Desktop/pm25_trial/analysis.R')
effect
source('~/Desktop/pm25_trial/analysis.R')
calc_average(pm_data, doi1, lag)
source('~/Desktop/pm25_trial/analysis.R')
calc_average(pm_data, doi1, lag)
source('~/Desktop/pm25_trial/analysis.R')
calc_average(pm_data, doi1, lag)
calc_average(pm_data, doi2, lag)
calc_average(pm_data, doi1, lag) %>%
mutate(stage = "stage1")
source('~/Desktop/pm25_trial/analysis.R')
pm
effect
inner_join(effect, pm, by=c("subject", "stage"))
source('~/Desktop/pm25_trial/analysis.R')
effect
lm(effect ~ stage + treatment + pm25,data=effect)
lm(effect ~ stage + treatment + pm25,data=effect) %>% summary()
aov(effect ~ stage + treatment, data=effect)
effect
aov(effect ~ stage + treatment + subject, data=effect)
aov(effect ~ stage + treatment + subject, data=effect) %>% summary()
source('~/Desktop/pm25_trial/analysis.R')
effect
aov(effect ~ stage + sequence + subject, data=effect) %>% summary()
library(lme4)
library(nlme)
nlme(effect ~ pm25 + pm10 + sequence + (1|subject), data=effect)
lmer(effect ~ pm25 + pm10 + sequence + (1|subject), data=effect)
lmer(effect ~ pm25 + pm10 + sequence + stage + (1|subject), data=effect)
lmer(effect ~ pm25 + sequence + stage + (1|subject), data=effect)
fit = lmer(effect ~ pm25 + sequence + stage + (1|subject), data=effect)
fit
source('~/Desktop/pm25_trial/analysis.R')
fit
summary(fit)
fit = lmer(effect ~ pm25*stage + sequence + (1|subject), data=effect)
fit
summary(fit)
fit = lmer(effect ~ pm25*stage + pm25*sequence + (1|subject), data=effect)
fit
summary(fit)
fit = lmer(effect ~ pm25 + stage + sequence + (1|subject), data=effect)
fit
lm(effect ~ pm25 + sequence, data=effect%>%filter(stage=="stage1"))
lm(effect ~ pm25 + sequence, data=effect%>%filter(stage=="stage1")) %>% summary()
lm(effect ~ pm25 + sequence, data=effect%>%filter(stage=="stage2")) %>% summary()
source('~/Desktop/pm25_trial/analysis.R')
aov(delta ~ pm25 + stage + sequence, data=effect)
aov(delta ~ pm25 + stage + sequence, data=effect) %>% summary()
effect$delta
qplot(effect$delta)
effect
spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject") %>%
gather("stage", "delta", 2:3) %>%
inner_join(pm, by=c("subject", "stage")) %>%
mutate(treatment = stage=="stage1"&sequence=="A")
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject") %>%
gather("stage", "delta", 2:3) %>%
inner_join(pm, by=c("subject", "stage")) %>%
mutate(treatment = (stage=="stage1"&sequence=="A")|(stage=="stage2"&sequence=="B"))
effect
effect = spread(biomarker_data, date, PGF) %>%
mutate(stage1 = .$`2020/11/8` - .$`2020/11/4`,
stage2 = .$`2020/11/16` - .$`2020/11/13`) %>%
select(subject, stage1, stage2) %>%
inner_join(treatment_data, by="subject") %>%
gather("stage", "delta", 2:3) %>%
mutate(treatment = (stage=="stage1"&sequence=="A")|(stage=="stage2"&sequence=="B")) %>%
inner_join(pm, by=c("subject", "stage"))
effect
source('~/Desktop/pm25_trial/analysis.R')
effect
aov(delta ~ pm25 + stage + treatment, data=effect)
aov(delta ~ pm25 + stage + treatment, data=effect) %>% summary()
aov(delta ~ subject + stage + treatment, data=effect)
aov(delta ~ subject + stage + treatment, data=effect) %>% summary()
effect
effect %>% na.omit()
aov(delta ~ subject + stage + treatment, data=effect) %>% summary()
shapiro.test(delta)
shapiro.test(effect$delta)
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==T))
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==T)) %>% summary()
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==F)) %>% summary()
source('~/Desktop/pm25_trial/analysis.R')
lmer(delta ~ pm25 + stage + treatment + (1|subject), data=effect)
fit = lmer(delta ~ pm25 + stage + treatment + (1|subject), data=effect)
fit %>% summary()
source('~/Desktop/pm25_trial/analysis.R')
fit = lmer(delta ~ (pm25/subject) + stage + treatment + (1|subject), data=effect)
fit = lmer(delta ~ stage + treatment + (1/subject), data=effect)
fit = lmer(delta ~ stage + treatment + (1|subject), data=effect)
fit = lmer(delta ~ pm25 + stage + treatment + (1|subject), data=effect)
fit = lmer(delta ~ (pm25|treatment) + stage + treatment + (1|subject), data=effect)
fit
fit = lmer(delta ~ pm25 + stage + (1|subject), data=filter(effect, treatment==T))
fit = lm(delta ~ pm25 + stage, data=filter(effect, treatment==T))
summary(fit)
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==T))
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==F))
lmer(delta ~ pm25 + stage + treatment + (1|subject), data=effect) %>% summary()
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==F)) %>% summary()
source('~/Desktop/pm25_trial/analysis.R')
source('~/Desktop/pm25_trial/analysis.R')
effect
source('~/Desktop/pm25_trial/analysis.R')
lm(delta ~ pm25 + stage, data = effect %>% filter(treatment==T)) %>% summary()
